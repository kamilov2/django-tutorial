{% extends 'base.html' %}
{% load static %}
{% block content %}

        <div id="main">
            <div class="container">




                <div class="row">
                    <div class="left" id="movie" itemscope itemtype="https://schema.org/Movie">
                        <meta itemprop="name" content="Гадкий я 4">
                        <meta itemprop="url" content="https://kinobase.org/film/231777-gadkiy-ya-4">
                        <meta itemprop="dateCreated" content="2024-08-05T19:42:07+03:00">
                        <meta itemprop="copyrightYear" content="2024">


                        <div class="row">
                           
                            <div id="media">
                                <div class="poster">
                                    <img src="{{object.cover.url}}"
                                        alt="Гадкий я 4" title="Гадкий я 4" itemprop="image" class="img_responsive"
                                        loading="lazy">
                                        <a href="{% url 'movie:add_to_favorite' movie.id %}" 
                                        class="favorite {% if movie in request.user.profile.favorites.all %} is_favorited {% endif %}" data-movie-id="231473" title="
                                        {% if movie in request.user.profile.favorites.all %}
                                        Удалить из избранного
                                        {% else %}
                                        Добавить в избранное
                                        {% endif %}"></a>

                                </div>


                                <div id="rating_block">
                                    <div id="rating_votes" class="clearfix">
                                        <div class="block">
                                            <span class="rt">
                                                <span class="rating_site" title="Кинобейс &ndash; 7.7 (2574)"></span>
                                                {{object.get_avg_rating|floatformat }} </span>
                                            <span class="num">{{movie.rating_count}}</span>
                                        </div>
                                        <div class="block">
                                            <span class="rt">
                                                <span class="rating_kp" title="КиноПоиск &ndash; 6.7 (25 866)"></span>
                                                <a href="https://www.kinopoisk.ru/film/1073122/" target="_blank">6.7</a>
                                            </span>
                                            <span class="num">25 866</span>
                                        </div>
                                        <div class="block">
                                            <span class="rt">
                                                <span class="rating_imdb" title="IMDb &ndash; 6.3 (19 836)"></span> 6.3
                                            </span>
                                            <span class="num">19 836</span>
                                        </div>
                                    </div>
                                    <style> 
                                        .rt-star{
                                            color:rgb(163, 163, 162);
                                            font: 1.5em sans-serif;
                                            cursor: pointer;
                                        }
                                        .rt-star:hover{
                                            color: orange;
                                        }
                                    </style>
                                    <span class="rating_stars">
                                        {% if not rating.value %}
                                        <a href="{% url 'movie:set_rating' 1 object.id %}" title="Оценить на 1" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 2 object.id %}" title="Оценить на 2" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 3 object.id %}" title="Оценить на 3" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 4 object.id %}" title="Оценить на 4" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 5 object.id %}" title="Оценить на 5" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 6 object.id %}" title="Оценить на 6" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 7 object.id %}" title="Оценить на 7" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 8 object.id %}" title="Оценить на 8" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 9 object.id %}" title="Оценить на 9" class="rt-star">★</a>
                                        <a href="{% url 'movie:set_rating' 10 object.id %}" title="Оценить на 10" class="rt-star">★</a>
                                        {% else %}
                                        <a href="{% url 'movie:set_rating' rating.value object.id %}" title="Удалить оценку" class="rt-star">★</a>
                                        {% endif %}
                                    </span>

                                    <input type="hidden" id="rating" value="7.7">

                                    <div id="rating_success">
                                        <span id="rating_text">Ваша оценка: 0</span>
                                        <span id="remove_rating">
                                            <svg height="14" width="14" class="icon" viewBox="0 0 96 96">
                                                <path fill-rule="evenodd"
                                                    d="M71.476 77.133a2.8 2.8 0 0 0 3.96 0l1.697-1.697a2.8 2.8 0 0 0 0-3.96L53.66 48.005l23.479-23.479a2.8 2.8 0 0 0 0-3.96l-1.697-1.696a2.8 2.8 0 0 0-3.96 0L48.003 42.347l-23.48-23.479a2.8 2.8 0 0 0-3.959 0l-1.697 1.697a2.8 2.8 0 0 0 0 3.96l23.48 23.48-23.474 23.472a2.8 2.8 0 0 0 0 3.96l1.697 1.697a2.8 2.8 0 0 0 3.96 0l23.473-23.473 23.473 23.472Z"
                                                    clip-rule="evenodd" />
                                            </svg>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <div id="info">

                                <div id="title">
                                    <h1>{{object.title}}</h1>
                                </div>

                                <div class="info_items">

                                    <div class="info_item">
                                        <div class="key">Название</div>
                                        <div class="value" itemprop="alternativeHeadline">{{object.origin_title}}</div>
                                    </div>

                                    <div class="info_item">
                                        <div class="key">Год</div>
                                        <div class="value"><a href="/films/2024">{{object.year}}</a></div>
                                    </div>

                                    <div class="info_item">
                                        <div class="key">Страна</div>
                                        <div class="value">
                                            {% for country in object.country %}
                                            <a href="#" rel="nofollow">{{ country.name }}</a>
                                            {% endfor %}
                                        </div>
                                    </div>

                                    <div class="info_item">
                                        <div class="key">Жанр</div>
                                        <div class="value">
                                            {% for genre in object.genre.all %}
                                            <a href="#" rel="nofollow">
                                                <span itemprop="genre">{{genre.name}}<span>
                                            </a>,
                                            {% endfor %}
                                        </div>
                                    </div>

                                    <div class="info_item">
                                        <div class="key">Режиссер</div>
                                        {% for role in object.roles.all %}
                                            <div class="value">
                                                {% if role.director %} 
                                                {% for author in role.author.all %}
                                                <span>
                                                    <a href="#" rel="nofollow">
                                                        <span>{{author.name}}</span>
                                                    </a>
                                                </span>
                                                {% endfor %} 
                                                {% endif %}
                                            </div>
                                        {% endfor %}
                                    </div>
        
                                    <div class="info_item">
                                        <div class="key">Продюсер</div>
                                        {% for role in object.roles.all %}
                                            <div class="value">
                                                {% if role.producer %} 
                                                {% for author in role.author.all %}
                                                <span>
                                                    <a href="#" rel="nofollow">
                                                        <span>{{author.name}}</span>
                                                    </a>
                                                </span>
                                                {% endfor %} 
                                                {% endif %}
                                            </div>
                                        {% endfor %}
                                    </div>
        
                                    <div class="info_item">
                                        <div class="key">Актеры</div>
                                        <div class="value">
                                                {% for role in object.roles.all %}
                                                {% if role.actor %} 
                                                {% for author in role.author.all %}
                                                <span>
                                                    <a href="#" rel="nofollow">
                                                        <span> {{ author.name }}, </span>
                                                    </a>
                                                </span>
                                                {% endfor %} 
                                                {% endif %}
                                                {% endfor %}
                                            </div>
                                    </div>
                                    
                                    <div class="info_item">
                                        <div class="key">Качество</div>
                                        <div class="value">{{object.quality|upper}}</div>
                                    </div>

                                    <div class="info_item">
                                        <div class="key">Время</div>
                                        <div class="value" itemprop="duration">{{object.duration}}</div>
                                    </div>


                                    <div class="info_item">
                                        <div class="key"></div>
                                        <div class="value"><a rel="nofollow" href="#" id="show_movie_info"
                                                class="muted">Больше информации</a></div>
                                    </div>

                                </div>

                                <div class="body" itemprop="description">{{object.description}}</div>

                                <div id="related">
                                    <h3>Сиквелы и приквелы</h3>
                                    <ul class="items">
                                        {% for movie in movie.related_films.all %}
                                        <li class="item">
                                          <div class="poster">
                                            <a href="{% url 'movie:movie_detail' movie.slug %}">
                                              <img src="{{movie.cover.url}}" class="img-responsive" loading="lazy" alt="{{movie.title}}" title="{{movie.title}}" width="242" height="358" /></a>
                                              <a href="{% url 'movie:add_to_favorite' movie.id %}" 
                                              class="favorite {% if movie in request.user.profile.favorites.all %} is_favorited {% endif %}" data-movie-id="231473" title="
                                              {% if movie in request.user.profile.favorites.all %}
                                              Удалить из избранного
                                              {% else %}
                                              Добавить в избранное
                                              {% endif %}"></a>
                                          </div>
                                          <div class="title">
                                            <a href="film/231473-navodnenie.html" alt="{{movie.title}}" title="{{movie.title}}">
                                              {{movie.title}}
                                            </a>
                                          </div>
                                          <span class="rating">{{movie.rating}}</span>
                                          <span class="year">{{movie.year}}, {{movie.quality|upper}}</span>
                                        </li>
                                      {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div id="watch">
                            <ul class="nav-tabs" id="tab-options">
                                <li><a rel="nofollow" href="#online" data-toggle="tab">СМОТРЕТЬ</a></li>
                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane" id="online">
                                    <div id="player"></div>

                                    <script>
                                    const player = new Playerjs({id:"player", file:"{{ object.file_url }}"});
                                    </script>
                                </div>
                            </div>

                            <div class="row">
                                <div class="left">
                                    <button id="btn_fav" class="btn" title="Добавить в избранное">В избранное</button>
                                </div>
                                <div class="right">
                                    <button class="btn player_settings" title="Настройки плеера">Настройки
                                        плеера</button>
                                </div>
                            </div>
                        </div>


                        <div id="comments">
                            <h3>{{comments.count}} комментариев</h3>

                            <form action="" id="comment_form" method="post">
                                {% csrf_token %}
                                <textarea class="input" minlength="3" name="comment" id="comment" rows="2" placeholder="Ваш комментарий"></textarea>
                                <button id="add_comment" class="btn" title="Добавить комментарий">Добавить</button>
                            </form>

                            <div id="comments_entries">
                                {% for comment in comments %}
                                <div class="comment new_comment" data-comment-id="">
                                    <div class="comment_avatar">
                                        {% if comment.user.profile.image %}
                                            <img class="img_circle" src="{{comment.user.profile.image.url}}" alt="">
                                        {% else %}
                                            <img class="img_circle" src="https://st.kinobase.org/static/images/avatar.svg" alt="">
                                        {% endif %}
                                    </div>
                                    <div class="comment_body">
                                        <div class="comment_head">
                                            <span class="username">{{comment.user.username}}</span>
                                            <span class="comment_date">{{comment.created_at}}</span>
                                        </div>
                                        <p>{{comment.text}}</p>
                                        <ul class="list-inline">
                                            <li class="showfull"><a rel="nofollow" href="javascript:void(0);"
                                                    class="muted" title="Показать весь комментарий">Показать весь
                                                    комментарий</a></li>
                                            {% if request.user.is_superuser %}
                                            <li class="remove">
                                                <a  href="{% url 'movie:comment_delete' comment.id %}"
                                                    class="muted" title="Удалить">Удалить</a>
                                            </li>
                                            {% endif %}
                                        </ul>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>

                        </div>

                    </div>

                    <div class="right" id="sidebar">
                    </div>

                </div>


            </div>
        </div>

{% endblock content %}